<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library - Your App</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        /* Base styles from the Design System Mood Board */
        body {
            font-family: 'Inter', sans-serif; /* Primary font */
            background-color: #F9FAFB; /* App background */
            color: #1A202C; /* Primary text and headings */
            line-height: 1.5;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Inter', sans-serif;
            color: #1A202C;
        }
        .section-title {
            font-weight: 800; /* Extra Bold for section titles */
            font-size: 24px; /* Title (H1) size */
            line-height: 32px; /* Title (H1) line height */
        }
        .card-title {
            font-weight: 600; /* Semi Bold for card titles */
            font-size: 18px; /* Subtitle (H2) size */
            line-height: 26px; /* Subtitle (H2) line height */
        }
        .body-text {
            font-weight: 400; /* Regular for body text */
            font-size: 14px; /* Body size */
            line-height: 20px; /* Body line height */
        }
        .metadata-text {
            font-weight: 300; /* Light for hints/timestamps */
            font-size: 12px; /* Caption size */
            line-height: 16px; /* Caption line height */
            color: #718096; /* Subtext color */
        }
        /* Custom Button Styles (from Design System Mood Board) */
        .btn {
            padding: 0.75rem 1.5rem;
            border-radius: 9999px; /* Fully rounded corners for pill shape */
            font-weight: 600; /* Semi Bold - button text */
            transition: all 0.2s ease-in-out; /* Smooth animations */
            display: inline-block;
            text-align: center;
            cursor: pointer;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }
        .btn-primary {
            background-color: #FF6B6B; /* Coral Red */
            color: #FFFFFF;
        }
        .btn-primary:hover {
            background-color: #FF8F8F; /* Lighter Coral Red for hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        .btn-secondary {
            background-color: #3DD9D6; /* Teal Blue */
            color: #1A202C; /* Primary text for contrast */
        }
        .btn-secondary:hover {
            background-color: #6AE0DD; /* Lighter Teal Blue for hover */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        /* Input Field Styles (from Design System Mood Board) */
        .input-field {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #E2E8F0; /* Borders color */
            border-radius: 0.5rem; /* Rounded corners */
            font-size: 14px; /* Body Text size */
            color: #1A202C; /* Primary text for input text */
            background-color: #EDF2F7; /* Containers color */
            transition: border-color 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .input-field::placeholder {
            color: #718096; /* Subtext for placeholder */
            font-weight: 400; /* Regular */
        }
        .input-field:focus {
            outline: none;
            border-color: #FF6B6B; /* Primary color for focus indicator */
            box-shadow: 0 0 0 3px rgba(255, 107, 107, 0.2); /* Soft shadow with Primary color */
        }

        /* Specific styles for this page */
        .sidebar {
            width: 72px; /* Fixed width as seen in screenshot */
            background-color: #FFFFFF;
            border-right: 1px solid #E2E8F0; /* Borders color */
            padding: 1.5rem 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05); /* Subtle shadow */
        }
        .sidebar-icon {
            display: flex;
            justify-content: center;
            align-items: center;
            width: 48px;
            height: 48px;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .sidebar-icon:hover {
            background-color: #EDF2F7; /* Containers color for hover */
        }
        .sidebar-icon.active {
            background-color: #EDF2F7; /* Containers color */
            color: #FF6B6B; /* Primary color for active icon */
        }
        .sidebar-divider {
            width: 40px;
            height: 1px;
            background-color: #E2E8F0; /* Borders color */
            margin: 1.5rem 0;
        }
        .main-content {
            flex-grow: 1;
            padding: 2rem;
        }
        .header-top {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }
        .header-actions {
            display: flex;
            gap: 1rem; /* Space between buttons */
        }
        .search-bar-container {
            flex-grow: 1; /* Allow search bar to take available space */
            margin-left: 2rem; /* Space between title and search */
            margin-right: 1rem;
            max-width: 400px; /* Limit search bar width */
        }
        .search-input {
            width: 100%;
            padding: 0.5rem 1rem;
            border: 1px solid #E2E8F0;
            border-radius: 0.5rem;
            background-color: #EDF2F7;
            font-size: 14px;
            color: #1A202C;
        }
        .search-input::placeholder {
            color: #718096;
        }
        .empty-state-card {
            background-color: #EDF2F7; /* Containers color */
            border: 1px solid #E2E8F0; /* Borders color */
            border-radius: 0.5rem;
            padding: 3rem 2rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-top: 3rem;
            color: #718096; /* Subtext */
        }
        .empty-state-icon {
            width: 100px;
            height: 100px;
            background-color: #E2E8F0; /* Borders color for placeholder icon */
            border-radius: 0.5rem;
            margin: 0 auto 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #718096;
        }
        .folder-table-header {
            background-color: #EDF2F7; /* Containers color */
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            font-weight: 600; /* Semi Bold */
            color: #1A202C; /* Primary text */
            margin-bottom: 0.5rem;
        }
        .folder-row-wrapper {
            background-color: #FFFFFF;
            border-radius: 0.5rem;
            margin-bottom: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03); /* Lighter shadow for rows */
            overflow: hidden; /* Hide overflowing content like files when collapsed */
        }
        .folder-row {
            padding: 1rem;
            display: flex;
            align-items: center;
            flex-wrap: wrap; /* Allow wrapping on smaller screens */
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .folder-row:hover {
            background-color: #F9FAFB; /* Background color for hover */
        }
        .folder-cell {
            flex: 1; /* Distribute space evenly */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding-right: 1rem;
        }
        .folder-name-cell {
            flex: 2; /* More space for folder name */
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-weight: 400; /* Regular */
            color: #1A202C; /* Primary text */
            min-width: 180px; /* Ensure it takes up enough space on small screens */
            margin-bottom: 0.5rem; /* Add some space if wrapping */
        }
        .folder-cell.details-cell {
            min-width: 120px; /* Min-width for other detail cells */
            margin-bottom: 0.5rem;
        }
        .folder-icon {
            width: 20px;
            height: 20px;
            border-radius: 0.25rem;
            background-color: #FFD166; /* Tertiary color for folder icon */
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: #1A202C;
        }
        .action-ellipsis {
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 9999px;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out;
        }
        .action-ellipsis:hover {
            background-color: #EDF2F7; /* Containers color for hover */
        }

        /* File row styles */
        .folder-files-container {
            padding-left: 2rem; /* Indent files */
            padding-bottom: 0.5rem;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-out;
        }
        .folder-files-container.open {
            max-height: 500px; /* Max height to allow transition, adjust as needed */
            transition: max-height 0.5s ease-in;
        }
        .file-row {
            display: flex;
            align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px dashed #E2E8F0; /* Subtle divider for files */
            font-size: 0.875rem; /* Smaller font for files */
            color: #1A202C;
        }
        .file-row:last-child {
            border-bottom: none;
        }
        .file-name-cell {
            flex: 3;
            font-weight: 400;
        }
        .file-language-cell {
            flex: 1;
            font-weight: 300;
            color: #718096;
            text-align: right;
            padding-right: 1rem;
        }
        .expand-toggle {
            background: none;
            border: none;
            padding: 0;
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
        }
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #FFFFFF;
            padding: 2rem;
            border-radius: 0.5rem;
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 90%;
            transform: translateY(-20px);
            transition: transform 0.3s ease-in-out;
            position: relative;
        }
        .modal-overlay.open .modal-content {
            transform: translateY(0);
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #718096;
        }
        .modal-summary-text {
            max-height: 300px; /* Limit height for summary content */
            overflow-y: auto; /* Scroll if content overflows */
            padding-right: 0.5rem; /* For scrollbar */
        }

        /* Responsive adjustments */
        @media (min-width: 768px) {
            .folder-table-header, .folder-row {
                display: grid;
                grid-template-columns: 2.5fr 2fr 1fr 1.5fr 0.5fr; /* Removed LLM Actions column */
                gap: 1rem;
                flex-wrap: nowrap; /* Disable wrapping on larger screens */
            }
            .folder-name-cell, .folder-cell.details-cell {
                margin-bottom: 0; /* Remove margin if not wrapping */
            }
            .folder-name-cell {
                flex: none; /* Disable flex on larger screens for grid */
            }
            .folder-cell {
                padding-right: 0; /* No extra padding for grid layout */
            }
            .header-top {
                flex-wrap: nowrap;
            }
            .header-actions {
                margin-left: auto; /* Push buttons to the right */
            }
        }
    </style>
</head>
<body class="flex min-h-screen">
    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="flex flex-col items-center space-y-6">
            <!-- App Logo/Icon Placeholder -->
            <div class="sidebar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="3" y="3" width="18" height="18" rx="4" fill="#FF6B6B"/>
                    <path d="M7 12H17M12 7V17" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </div>
            <div class="sidebar-icon active">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="text-[#FF6B6B]">
                    <path d="M8 4H4C3.44772 4 3 4.44772 3 5V8C3 8.55228 3.44772 9 4 9H8C8.55228 9 9 8.55228 9 8V5C9 4.44772 8.55228 4 8 4Z"></path>
                    <path d="M20 4H16C15.4477 4 15 4.44772 15 5V8C15 8.55228 15.4477 9 16 9H20C20.5523 9 21 8.55228 21 8V5C21 4.44772 20.5523 4 20 4Z"></path>
                    <path d="M8 15H4C3.44772 15 3 15.4477 3 16V19C3 19.5523 3.44772 20 4 20H8C8.55228 20 9 19.5523 9 19V16C9 15.4477 8.55228 15 8 15Z"></path>
                    <path d="M20 15H16C15.4477 15 15 15.4477 15 16V19C15 19.5523 15.4477 20 16 20H20C20.5523 20 21 19.5523 21 19V16C21 15.4477 20.5523 15 20 15Z"></path>
                </svg>
            </div>
            <div class="sidebar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M9 18V5l12-2v13"></path><path d="M9 18C7.68629 18 6.55169 18.2366 5.67919 18.6653C4.80669 19.094 4.09919 19.6738 3.65919 20.3014C3.21919 20.929 2.99919 21.6062 2.99919 22.3168C2.99919 22.9566 3.14919 23.5516 3.44919 24.0863C3.74919 24.621 4.19919 25.071 4.79919 25.4194"></path><path d="M21 16C19.6863 16 18.5517 16.2366 17.6792 16.6653C16.8067 17.094 16.0992 17.6738 15.6592 18.3014C15.2192 18.929 14.9992 19.6062 14.9992 20.3168C14.9992 20.9566 15.1492 21.5516 15.4492 22.0863C15.7492 22.621 16.1992 23.071 16.7992 23.4194"></path>
                </svg>
            </div>
            <div class="sidebar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="2" y="7" width="20" height="15" rx="2" ry="2"></rect><path d="M16 3h-8v4h8V3z"></path>
                </svg>
            </div>
            <div class="sidebar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
                </svg>
            </div>
            <div class="sidebar-icon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M17 12a5 5 0 1 1-10 0 5 5 0 0 1 10 0z"></path><path d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"></path>
                </svg>
            </div>
            <div class="sidebar-divider"></div>
            <div class="sidebar-icon text-sm metadata-text px-2 py-1 rounded-full bg-[#EDF2F7] text-[#718096]">
                <small>RECORDED</small>
            </div>
        </div>
        <!-- User Profile Placeholder -->
        <div class="sidebar-icon mb-4">
            <div class="w-10 h-10 rounded-full bg-gray-300 flex items-center justify-center text-xl font-semibold text-gray-600">
                <img src="https://placehold.co/40x40/EDF2F7/718096?text=U" alt="User Avatar" class="rounded-full">
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="main-content">
        <header class="mb-8">
            <div class="header-top">
                <h1 class="section-title">Library</h1>
                <div class="search-bar-container relative">
                    <input type="text" class="search-input" placeholder="Search...">
                    <svg class="absolute right-3 top-1/2 -translate-y-1/2 text-[#718096]" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="11" cy="11" r="8"></circle>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                    </svg>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary flex items-center gap-2">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-white">
                            <line x1="12" y1="5" x2="12" y2="19"></line>
                            <line x1="5" y1="12" x2="19" y2="12"></line>
                        </svg>
                        Add folder
                    </button>
                    <button class="btn btn-secondary flex items-center gap-2">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-[#1A202C]">
                            <path d="M22 3H2l8 9.46V21l4-2v-7.54L22 3z"></path>
                        </svg>
                        Filters
                    </button>
                </div>
            </div>
            <!-- "Last added" moved below header-top if needed, or removed if the screenshot only implies folder list -->
        </header>

        <!-- "Last added" Section - Kept for consistency, but consider removing if not explicitly in screenshot -->
        <div class="mb-8">
            <h3 class="card-title mb-4">Last added</h3>
            <!-- Empty state for "Last added" -->
            <div class="empty-state-card flex flex-col items-center">
                <div class="empty-state-icon">
                    <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                        <line x1="12" y1="8" x2="12" y2="16"></line>
                        <line x1="8" y1="12" x2="16" y2="12"></line>
                    </svg>
                </div>
                <p class="body-text mb-2 text-center text-[#718096]">You don't have any file added yet</p>
                <p class="metadata-text text-center text-[#718096]">Add calls, video meeting, snippets to library</p>
            </div>
        </div>

        <!-- "Folders" Section -->
        <div>
            <h3 class="card-title mb-4">Folders <span class="metadata-text text-[#718096] font-normal ml-2">97</span></h3>

            <!-- Folder Table Header -->
            <div class="folder-table-header hidden md:grid">
                <div class="folder-cell flex items-center gap-2">Folder name</div>
                <div class="folder-cell">Created by</div>
                <div class="folder-cell">No. of files</div>
                <div class="folder-cell">Last modified</div>
                <div class="folder-cell text-center">Action</div>
            </div>

            <!-- Folder Rows (Example Data) -->
            <div class="space-y-3 mt-4" id="folder-list">
                <!-- Folder data will be rendered here by JavaScript -->
            </div>
        </div>
    </main>

    <!-- Summary Modal (Kept, but no longer directly triggered from folder rows) -->
    <div id="summaryModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" onclick="closeModal()">&times;</button>
            <h3 class="card-title mb-4">Summary of <span id="summaryModalTitle" class="text-[#FF6B6B]"></span></h3>
            <div id="summaryModalBody" class="modal-summary-text body-text text-[#1A202C]">
                <p id="summaryText">Loading summary...</p>
                <div id="loadingSpinner" class="flex justify-center items-center py-4">
                    <svg class="animate-spin h-8 w-8 text-[#FF6B6B]" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data for demonstration
        const foldersData = [
            {
                id: "folder1",
                name: "Atmadeep",
                createdBy: "Atmadeep Das",
                filesCount: 36,
                lastModified: "1:49 pm | Jun 19, 2025",
                isExpanded: false,
                files: [
                    { name: "Project Plan Q3.docx", language: "eng" },
                    { name: "Meeting Notes Week 24.pdf", language: "eng" },
                    { name: "Risk Assessment Report.pptx", language: "fr" },
                    { name: "Team Performance Metrics.xlsx", language: "eng" },
                ]
            },
            {
                id: "folder2",
                name: "Meritxell - Bingo Challenge",
                createdBy: "Meritxell Aguilera",
                filesCount: 4,
                lastModified: "11:58 am | Jun 18, 2025",
                isExpanded: false,
                files: [
                    { name: "Challenge Rules.pdf", language: "es" },
                    { name: "Participant List.xlsx", language: "eng" },
                    { name: "Progress Tracker.gsheet", language: "es" },
                    { name: "Weekly Check-in.docx", language: "es" },
                ]
            },
            {
                id: "folder3",
                name: "Maria - Bingo Challenge",
                createdBy: "Maria Mozo Ferrero",
                filesCount: 6,
                lastModified: "11:51 am | Jun 18, 2025",
                isExpanded: false,
                files: [
                    { name: "Maria's Rules.pdf", language: "es" },
                    { name: "Participant Feedback.docx", language: "es" },
                    { name: "Results Summary.xlsx", language: "es" },
                    { name: "Kickoff Meeting.mp4", language: "eng" },
                    { name: "Recap Notes.txt", language: "fr" },
                    { name: "Scorecard.pdf", language: "es" },
                ]
            },
            {
                id: "folder4",
                name: "Sales Academy - Best practices",
                createdBy: "Unknown",
                filesCount: 0,
                lastModified: "10:03 am | Jun 18, 2025",
                isExpanded: false,
                files: []
            },
            {
                id: "folder5",
                name: "Sabine",
                createdBy: "Sabine Haasser",
                filesCount: 0,
                lastModified: "5:05 pm | Jun 17, 2025",
                isExpanded: false,
                files: []
            },
            {
                id: "folder6",
                name: "Nouveau dossier",
                createdBy: "Franck Youn",
                filesCount: 0,
                lastModified: "4:58 am | Jun 17, 2025",
                isExpanded: false,
                files: []
            },
        ];

        // Function to simulate file content for LLM processing (kept for potential future use, though not directly called now)
        function getFolderContentForLLM(folderName) {
            let content = "";
            const folder = foldersData.find(f => f.name === folderName);
            if (folder) {
                content += `Folder Name: ${folder.name}\n`;
                content += `Created By: ${folder.createdBy}\n`;
                content += `Number of Files: ${folder.filesCount}\n`;
                content += `Last Modified: ${folder.lastModified}\n\n`;
                if (folder.files && folder.files.length > 0) {
                    content += "Files within this folder:\n";
                    folder.files.forEach(file => {
                        content += `- File Name: ${file.name}, Language: ${file.language}\n`;
                        // Add some generic mock content for each file to make the summary more meaningful
                        content += `  (This file discusses concepts related to ${file.name.toLowerCase().replace(/\..*$/, '').replace(/-/g, ' ').replace(/_/g, ' ')}. Its primary language is ${file.language}.)\n`;
                    });
                } else {
                    content += "This folder contains no files.\n";
                }
            }
            return content;
        }

        // Function to render all folders and their files
        function renderFolders() {
            const folderListContainer = document.getElementById('folder-list');
            folderListContainer.innerHTML = ''; // Clear existing content

            foldersData.forEach(folder => {
                const folderWrapper = document.createElement('div');
                folderWrapper.className = 'folder-row-wrapper';
                folderWrapper.setAttribute('data-folder-id', folder.id);

                const folderRow = document.createElement('div');
                folderRow.className = 'folder-row';
                folderRow.onclick = (event) => toggleFolder(folder.id, event); // Make the whole row clickable

                folderRow.innerHTML = `
                    <div class="folder-name-cell">
                        <button class="expand-toggle text-[#718096] mr-2" aria-expanded="${folder.isExpanded}">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="transition-transform duration-200 ${folder.isExpanded ? 'rotate-90' : ''}">
                                <polyline points="9 18 15 12 9 6"></polyline>
                            </svg>
                        </button>
                        <span class="folder-icon">ðŸ“‚</span> ${folder.name}
                    </div>
                    <div class="folder-cell details-cell body-text text-[#1A202C]">${folder.createdBy}</div>
                    <div class="folder-cell details-cell body-text text-[#1A202C]">${folder.filesCount}</div>
                    <div class="folder-cell details-cell body-text text-[#1A202C]">${folder.lastModified}</div>
                    <div class="folder-cell flex justify-center items-center">
                        <button class="action-ellipsis text-[#718096] hover:bg-[#EDF2F7]">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <circle cx="12" cy="12" r="2"></circle>
                                <circle cx="12" cy="5" r="2"></circle>
                                <circle cx="12" cy="19" r="2"></circle>
                            </svg>
                        </button>
                    </div>
                `;
                folderWrapper.appendChild(folderRow);

                // Create container for files
                const filesContainer = document.createElement('div');
                filesContainer.id = `files-for-${folder.id}`;
                filesContainer.className = `folder-files-container ${folder.isExpanded ? 'open' : ''}`;

                if (folder.isExpanded && folder.files && folder.files.length > 0) {
                    folder.files.forEach(file => {
                        const fileRow = document.createElement('div');
                        fileRow.className = 'file-row';
                        fileRow.innerHTML = `
                            <div class="file-name-cell body-text ml-4">ðŸ“„ ${file.name}</div>
                            <div class="file-language-cell metadata-text">${file.language.toUpperCase()}</div>
                        `;
                        filesContainer.appendChild(fileRow);
                    });
                } else if (folder.isExpanded && folder.filesCount === 0) {
                     const noFilesMessage = document.createElement('div');
                     noFilesMessage.className = 'file-row body-text text-center text-[#718096]';
                     noFilesMessage.textContent = 'No files in this folder.';
                     filesContainer.appendChild(noFilesMessage);
                }

                folderWrapper.appendChild(filesContainer);
                folderListContainer.appendChild(folderWrapper);
            });
        }

        // Toggle folder expanded state
        function toggleFolder(id, event) {
            const folderIndex = foldersData.findIndex(f => f.id === id);
            if (folderIndex !== -1) {
                foldersData[folderIndex].isExpanded = !foldersData[folderIndex].isExpanded;
                renderFolders(); // Re-render to reflect the change
            }
        }

        // LLM related functions (kept for future reference, though summary modal is not directly triggered now)
        const summaryModal = document.getElementById('summaryModal');
        const summaryModalTitle = document.getElementById('summaryModalTitle');
        const summaryText = document.getElementById('summaryText');
        const loadingSpinner = document.getElementById('loadingSpinner');

        // This function is no longer called directly from the UI, but kept in case LLM features are re-introduced
        async function summarizeFolder(id) {
            const folder = foldersData.find(f => f.id === id);
            if (!folder) return;

            summaryModalTitle.textContent = folder.name;
            summaryText.textContent = ''; // Clear previous summary
            loadingSpinner.classList.remove('hidden'); // Show spinner
            summaryModal.classList.add('open'); // Open modal

            try {
                const folderContentForLLM = getFolderContentForLLM(folder.name);
                const prompt = "Summarize the following folder content in a concise paragraph, highlighting key themes and languages:\n\n" + folderContentForLLM;

                let chatHistory = [];
                chatHistory.push({ role: "user", parts: [{ text: prompt }] });
                const payload = { contents: chatHistory };
                const apiKey = ""; // Canvas will provide this at runtime for gemini-2.0-flash
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    const text = result.candidates[0].content.parts[0].text;
                    summaryText.textContent = text;
                } else {
                    summaryText.textContent = "Could not generate summary. Please try again.";
                    console.error("LLM response structure unexpected:", result);
                }
            } catch (error) {
                summaryText.textContent = "Error generating summary: " + error.message;
                console.error("Error calling Gemini API:", error);
            } finally {
                loadingSpinner.classList.add('hidden'); // Hide spinner
            }
        }

        function closeModal() {
            summaryModal.classList.remove('open');
            summaryText.textContent = ''; // Clear summary when closing
        }

        // Initial render on page load
        document.addEventListener('DOMContentLoaded', renderFolders);
    </script>
</body>
</html>
